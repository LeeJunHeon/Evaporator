# -*- coding: utf-8 -*-

################################################################################
## Form generated from reading UI file 'EvaporatoriTdLHg.ui'
##
## Created by: Qt User Interface Compiler version 6.9.1
##
## WARNING! All changes made in this file will be lost when recompiling UI file!
################################################################################

from PySide6.QtCore import (QCoreApplication, QDate, QDateTime, QLocale,
    QMetaObject, QObject, QPoint, QRect,
    QSize, QTime, QUrl, Qt)
from PySide6.QtGui import (QBrush, QColor, QConicalGradient, QCursor,
    QFont, QFontDatabase, QGradient, QIcon,
    QImage, QKeySequence, QLinearGradient, QPainter,
    QPalette, QPixmap, QRadialGradient, QTransform)
from PySide6.QtWidgets import (QApplication, QFrame, QLabel, QLineEdit,
    QPushButton, QSizePolicy, QStackedWidget, QWidget)

class Ui_Form(object):
    def setupUi(self, Form):
        if not Form.objectName():
            Form.setObjectName(u"Form")
        Form.resize(1149, 703)
        Form.setAutoFillBackground(True)
        self.stackedWidget = QStackedWidget(Form)
        self.stackedWidget.setObjectName(u"stackedWidget")
        self.stackedWidget.setGeometry(QRect(0, 0, 1151, 701))
        self.page = QWidget()
        self.page.setObjectName(u"page")

        self.frame_19 = QFrame(self.page)
        self.frame_19.setObjectName(u"frame_19")
        self.frame_19.setGeometry(QRect(1070, 340, 16, 191))
        self.frame_19.setAutoFillBackground(True)
        self.frame_19.setFrameShape(QFrame.Shape.StyledPanel)
        self.frame_19.setFrameShadow(QFrame.Shadow.Raised)

        self.pushButton_13 = QPushButton(self.page)
        self.pushButton_13.setObjectName(u"pushButton_13")
        self.pushButton_13.setGeometry(QRect(780, 370, 101, 71))

        self.frame_7 = QFrame(self.page)
        self.frame_7.setObjectName(u"frame_7")
        self.frame_7.setGeometry(QRect(140, 340, 71, 16))
        self.frame_7.setAutoFillBackground(True)
        self.frame_7.setFrameShape(QFrame.Shape.StyledPanel)
        self.frame_7.setFrameShadow(QFrame.Shadow.Raised)

        self.frame_9 = QFrame(self.page)
        self.frame_9.setObjectName(u"frame_9")
        self.frame_9.setGeometry(QRect(210, 410, 16, 141))
        self.frame_9.setAutoFillBackground(True)
        self.frame_9.setFrameShape(QFrame.Shape.StyledPanel)
        self.frame_9.setFrameShadow(QFrame.Shadow.Raised)

        self.frame_8 = QFrame(self.page)
        self.frame_8.setObjectName(u"frame_8")
        self.frame_8.setGeometry(QRect(420, 400, 16, 141))
        self.frame_8.setAutoFillBackground(True)
        self.frame_8.setFrameShape(QFrame.Shape.StyledPanel)
        self.frame_8.setFrameShadow(QFrame.Shadow.Raised)

        self.ms2powerBtn = QPushButton(self.page)
        self.ms2powerBtn.setObjectName(u"ms2powerBtn")
        self.ms2powerBtn.setGeometry(QRect(480, 500, 101, 71))

        self.ftmBtn = QPushButton(self.page)
        self.ftmBtn.setObjectName(u"ftmBtn")
        self.ftmBtn.setGeometry(QRect(270, 60, 101, 71))

        self.rpBtn = QPushButton(self.page)
        self.rpBtn.setObjectName(u"rpBtn")
        self.rpBtn.setGeometry(QRect(780, 480, 101, 71))

        self.frame_13 = QFrame(self.page)
        self.frame_13.setObjectName(u"frame_13")
        self.frame_13.setGeometry(QRect(630, 400, 401, 16))
        self.frame_13.setAutoFillBackground(True)
        self.frame_13.setFrameShape(QFrame.Shape.StyledPanel)
        self.frame_13.setFrameShadow(QFrame.Shadow.Raised)

        self.mvBtn = QPushButton(self.page)
        self.mvBtn.setObjectName(u"mvBtn")
        self.mvBtn.setGeometry(QRect(640, 370, 101, 71))

        self.widget = QWidget(self.page)
        self.widget.setObjectName(u"widget")
        self.widget.setGeometry(QRect(190, 160, 261, 261))
        self.widget.setAutoFillBackground(True)

        self.frame_2 = QFrame(self.page)
        self.frame_2.setObjectName(u"frame_2")
        self.frame_2.setGeometry(QRect(150, 630, 120, 16))
        self.frame_2.setAutoFillBackground(True)
        self.frame_2.setFrameShape(QFrame.Shape.StyledPanel)
        self.frame_2.setFrameShadow(QFrame.Shadow.Raised)

        self.frame_6 = QFrame(self.page)
        self.frame_6.setObjectName(u"frame_6")
        self.frame_6.setGeometry(QRect(370, 410, 16, 231))
        self.frame_6.setAutoFillBackground(True)
        self.frame_6.setFrameShape(QFrame.Shape.StyledPanel)
        self.frame_6.setFrameShadow(QFrame.Shadow.Raised)

        self.frame_16 = QFrame(self.page)
        self.frame_16.setObjectName(u"frame_16")
        self.frame_16.setGeometry(QRect(1010, 290, 16, 121))
        self.frame_16.setAutoFillBackground(True)
        self.frame_16.setFrameShape(QFrame.Shape.StyledPanel)
        self.frame_16.setFrameShadow(QFrame.Shadow.Raised)

        self.frame_4 = QFrame(self.page)
        self.frame_4.setObjectName(u"frame_4")
        self.frame_4.setGeometry(QRect(370, 630, 120, 16))
        self.frame_4.setAutoFillBackground(True)
        self.frame_4.setFrameShape(QFrame.Shape.StyledPanel)
        self.frame_4.setFrameShadow(QFrame.Shadow.Raised)

        self.frame_3 = QFrame(self.page)
        self.frame_3.setObjectName(u"frame_3")
        self.frame_3.setGeometry(QRect(420, 530, 71, 16))
        self.frame_3.setAutoFillBackground(True)
        self.frame_3.setFrameShape(QFrame.Shape.StyledPanel)
        self.frame_3.setFrameShadow(QFrame.Shadow.Raised)

        self.fvBtn = QPushButton(self.page)
        self.fvBtn.setObjectName(u"fvBtn")
        self.fvBtn.setGeometry(QRect(920, 370, 101, 71))

        self.frame_5 = QFrame(self.page)
        self.frame_5.setObjectName(u"frame_5")
        self.frame_5.setGeometry(QRect(260, 415, 16, 231))
        self.frame_5.setAutoFillBackground(True)
        self.frame_5.setFrameShape(QFrame.Shape.StyledPanel)
        self.frame_5.setFrameShadow(QFrame.Shadow.Raised)

        self.frame_10 = QFrame(self.page)
        self.frame_10.setObjectName(u"frame_10")
        self.frame_10.setGeometry(QRect(140, 230, 71, 16))
        self.frame_10.setAutoFillBackground(True)
        self.frame_10.setFrameShape(QFrame.Shape.StyledPanel)
        self.frame_10.setFrameShadow(QFrame.Shadow.Raised)

        self.processBtn = QPushButton(self.page)
        self.processBtn.setObjectName(u"processBtn")
        self.processBtn.setGeometry(QRect(60, 20, 101, 71))

        self.frame_18 = QFrame(self.page)
        self.frame_18.setObjectName(u"frame_18")
        self.frame_18.setGeometry(QRect(860, 510, 231, 16))
        self.frame_18.setAutoFillBackground(True)
        self.frame_18.setFrameShape(QFrame.Shape.StyledPanel)
        self.frame_18.setFrameShadow(QFrame.Shadow.Raised)

        self.frame_14 = QFrame(self.page)
        self.frame_14.setObjectName(u"frame_14")
        self.frame_14.setGeometry(QRect(630, 290, 401, 16))
        self.frame_14.setAutoFillBackground(True)
        self.frame_14.setFrameShape(QFrame.Shape.StyledPanel)
        self.frame_14.setFrameShadow(QFrame.Shadow.Raised)

        self.frame_11 = QFrame(self.page)
        self.frame_11.setObjectName(u"frame_11")
        self.frame_11.setGeometry(QRect(430, 230, 71, 16))
        self.frame_11.setAutoFillBackground(True)
        self.frame_11.setFrameShape(QFrame.Shape.StyledPanel)
        self.frame_11.setFrameShadow(QFrame.Shadow.Raised)

        self.rvBtn = QPushButton(self.page)
        self.rvBtn.setObjectName(u"rvBtn")
        self.rvBtn.setGeometry(QRect(780, 260, 101, 71))

        self.frame = QFrame(self.page)
        self.frame.setObjectName(u"frame")
        self.frame.setGeometry(QRect(150, 530, 71, 16))
        self.frame.setAutoFillBackground(True)
        self.frame.setFrameShape(QFrame.Shape.StyledPanel)
        self.frame.setFrameShadow(QFrame.Shadow.Raised)

        self.vvBtn = QPushButton(self.page)
        self.vvBtn.setObjectName(u"vvBtn")
        self.vvBtn.setGeometry(QRect(60, 200, 101, 71))

        self.frame_20 = QFrame(self.page)
        self.frame_20.setObjectName(u"frame_20")
        self.frame_20.setGeometry(QRect(1010, 340, 71, 16))
        self.frame_20.setAutoFillBackground(True)
        self.frame_20.setFrameShape(QFrame.Shape.StyledPanel)
        self.frame_20.setFrameShadow(QFrame.Shadow.Raised)

        self.doorBtn = QPushButton(self.page)
        self.doorBtn.setObjectName(u"doorBtn")
        self.doorBtn.setGeometry(QRect(60, 310, 101, 71))

        self.ms2shutterBtn = QPushButton(self.page)
        self.ms2shutterBtn.setObjectName(u"ms2shutterBtn")
        self.ms2shutterBtn.setGeometry(QRect(480, 600, 101, 71))

        self.frame_15 = QFrame(self.page)
        self.frame_15.setObjectName(u"frame_15")
        self.frame_15.setGeometry(QRect(620, 290, 16, 131))
        self.frame_15.setAutoFillBackground(True)
        self.frame_15.setFrameShape(QFrame.Shape.StyledPanel)
        self.frame_15.setFrameShadow(QFrame.Shadow.Raised)

        self.ms1shutterBtn = QPushButton(self.page)
        self.ms1shutterBtn.setObjectName(u"ms1shutterBtn")
        self.ms1shutterBtn.setGeometry(QRect(60, 600, 101, 71))

        self.frame_12 = QFrame(self.page)
        self.frame_12.setObjectName(u"frame_12")
        self.frame_12.setGeometry(QRect(310, 110, 16, 71))
        self.frame_12.setAutoFillBackground(True)
        self.frame_12.setFrameShape(QFrame.Shape.StyledPanel)
        self.frame_12.setFrameShadow(QFrame.Shadow.Raised)

        self.mainshutterBtn = QPushButton(self.page)
        self.mainshutterBtn.setObjectName(u"mainshutterBtn")
        self.mainshutterBtn.setGeometry(QRect(480, 200, 101, 71))

        self.frame_17 = QFrame(self.page)
        self.frame_17.setObjectName(u"frame_17")
        self.frame_17.setGeometry(QRect(410, 340, 211, 16))
        self.frame_17.setAutoFillBackground(True)
        self.frame_17.setFrameShape(QFrame.Shape.StyledPanel)
        self.frame_17.setFrameShadow(QFrame.Shadow.Raised)

        self.ms1powerBtn = QPushButton(self.page)
        self.ms1powerBtn.setObjectName(u"ms1powerBtn")
        self.ms1powerBtn.setGeometry(QRect(60, 500, 101, 71))

        self.stackedWidget.addWidget(self.page)

        # Raise order (원본 유지)
        self.frame_2.raise_()
        self.frame_19.raise_()
        self.frame_7.raise_()
        self.frame_9.raise_()
        self.frame_8.raise_()
        self.rpBtn.raise_()
        self.frame_13.raise_()
        self.mvBtn.raise_()
        self.frame_6.raise_()
        self.frame_16.raise_()
        self.frame_4.raise_()
        self.frame_3.raise_()
        self.fvBtn.raise_()
        self.frame_5.raise_()
        self.frame_10.raise_()
        self.processBtn.raise_()
        self.frame_18.raise_()
        self.frame_14.raise_()
        self.frame_11.raise_()
        self.rvBtn.raise_()
        self.frame.raise_()
        self.vvBtn.raise_()
        self.frame_20.raise_()
        self.doorBtn.raise_()
        self.ms2shutterBtn.raise_()
        self.frame_15.raise_()
        self.ms1shutterBtn.raise_()
        self.frame_12.raise_()
        self.mainshutterBtn.raise_()
        self.frame_17.raise_()
        self.ms1powerBtn.raise_()
        self.pushButton_13.raise_()
        self.ms2powerBtn.raise_()
        self.ftmBtn.raise_()
        self.widget.raise_()

        self.page_2 = QWidget()
        self.page_2.setObjectName(u"page_2")

        self.materialEdit = QLineEdit(self.page_2)
        self.materialEdit.setObjectName(u"materialEdit")
        self.materialEdit.setGeometry(QRect(10, 140, 181, 26))

        self.graphWidget = QWidget(self.page_2)
        self.graphWidget.setObjectName(u"graphWidget")
        self.graphWidget.setGeometry(QRect(209, 10, 921, 511))
        self.graphWidget.setAutoFillBackground(True)

        self.deprateEdit = QLineEdit(self.page_2)
        self.deprateEdit.setObjectName(u"deprateEdit")
        self.deprateEdit.setGeometry(QRect(10, 200, 181, 26))

        self.powerEdit = QLineEdit(self.page_2)
        self.powerEdit.setObjectName(u"powerEdit")
        self.powerEdit.setGeometry(QRect(10, 260, 181, 26))

        self.thicknessEdit = QLineEdit(self.page_2)
        self.thicknessEdit.setObjectName(u"thicknessEdit")
        self.thicknessEdit.setGeometry(QRect(10, 380, 181, 26))

        self.delayEdit = QLineEdit(self.page_2)
        self.delayEdit.setObjectName(u"delayEdit")
        self.delayEdit.setGeometry(QRect(10, 320, 181, 26))

        self.materialLabel = QLabel(self.page_2)
        self.materialLabel.setObjectName(u"materialLabel")
        self.materialLabel.setGeometry(QRect(10, 120, 181, 20))
        self.materialLabel.setAlignment(Qt.AlignmentFlag.AlignLeading|Qt.AlignmentFlag.AlignLeft|Qt.AlignmentFlag.AlignVCenter)

        self.stopProcess = QPushButton(self.page_2)
        self.stopProcess.setObjectName(u"stopProcess")
        self.stopProcess.setGeometry(QRect(110, 450, 87, 71))

        self.startProcess = QPushButton(self.page_2)
        self.startProcess.setObjectName(u"startProcess")
        self.startProcess.setGeometry(QRect(10, 450, 87, 71))

        self.logWindow = QLineEdit(self.page_2)
        self.logWindow.setObjectName(u"logWindow")
        self.logWindow.setGeometry(QRect(0, 530, 1131, 171))

        self.thicknessLabel = QLabel(self.page_2)
        self.thicknessLabel.setObjectName(u"thicknessLabel")
        self.thicknessLabel.setGeometry(QRect(10, 360, 181, 20))
        self.thicknessLabel.setAlignment(Qt.AlignmentFlag.AlignLeading|Qt.AlignmentFlag.AlignLeft|Qt.AlignmentFlag.AlignVCenter)

        self.delayLabel = QLabel(self.page_2)
        self.delayLabel.setObjectName(u"delayLabel")
        self.delayLabel.setGeometry(QRect(10, 300, 181, 20))
        self.delayLabel.setAlignment(Qt.AlignmentFlag.AlignLeading|Qt.AlignmentFlag.AlignLeft|Qt.AlignmentFlag.AlignVCenter)

        self.pwoerLabel = QLabel(self.page_2)
        self.pwoerLabel.setObjectName(u"pwoerLabel")
        self.pwoerLabel.setGeometry(QRect(10, 240, 181, 20))
        self.pwoerLabel.setAlignment(Qt.AlignmentFlag.AlignLeading|Qt.AlignmentFlag.AlignLeft|Qt.AlignmentFlag.AlignVCenter)

        self.deprateLabel = QLabel(self.page_2)
        self.deprateLabel.setObjectName(u"deprateLabel")
        self.deprateLabel.setGeometry(QRect(10, 180, 181, 20))
        self.deprateLabel.setAlignment(Qt.AlignmentFlag.AlignLeading|Qt.AlignmentFlag.AlignLeft|Qt.AlignmentFlag.AlignVCenter)

        self.evaporatorLabel = QLabel(self.page_2)
        self.evaporatorLabel.setObjectName(u"evaporatorLabel")
        self.evaporatorLabel.setGeometry(QRect(10, 10, 181, 31))
        font = QFont()
        font.setPointSize(19)
        self.evaporatorLabel.setFont(font)
        self.evaporatorLabel.setAlignment(Qt.AlignmentFlag.AlignCenter)

        self.hmiBtn = QPushButton(self.page_2)
        self.hmiBtn.setObjectName(u"hmiBtn")
        self.hmiBtn.setGeometry(QRect(10, 50, 181, 61))

        self.stackedWidget.addWidget(self.page_2)

        # --- Custom UI styling/alignment (manual edit) ---
        self._apply_custom_ui()

        self.retranslateUi(Form)

        self.stackedWidget.setCurrentIndex(0)

        QMetaObject.connectSlotsByName(Form)
    # setupUi

    def retranslateUi(self, Form):
        Form.setWindowTitle(QCoreApplication.translate("Form", u"Form", None))
        self.pushButton_13.setText(QCoreApplication.translate("Form", u"T . M . P", None))
        self.ms2powerBtn.setText(QCoreApplication.translate("Form", u"M.S 2 Power", None))
        self.ftmBtn.setText(QCoreApplication.translate("Form", u"F . T . M", None))
        self.rpBtn.setText(QCoreApplication.translate("Form", u"R / P", None))
        self.mvBtn.setText(QCoreApplication.translate("Form", u"M / V", None))
        self.fvBtn.setText(QCoreApplication.translate("Form", u"F / V", None))
        self.processBtn.setText(QCoreApplication.translate("Form", u"Process", None))
        self.rvBtn.setText(QCoreApplication.translate("Form", u"R / V", None))
        self.vvBtn.setText(QCoreApplication.translate("Form", u"V / V", None))
        self.doorBtn.setText(QCoreApplication.translate("Form", u"Door", None))
        self.ms2shutterBtn.setText(QCoreApplication.translate("Form", u"M.S 2 Shutter", None))
        self.ms1shutterBtn.setText(QCoreApplication.translate("Form", u"M.S 1 Shutter", None))
        self.mainshutterBtn.setText(QCoreApplication.translate("Form", u"Main Shutter", None))
        self.ms1powerBtn.setText(QCoreApplication.translate("Form", u"M.S 1 Power", None))
        self.materialLabel.setText(QCoreApplication.translate("Form", u"Material Name", None))
        self.stopProcess.setText(QCoreApplication.translate("Form", u"Start", None))
        self.startProcess.setText(QCoreApplication.translate("Form", u"Stop", None))
        self.thicknessLabel.setText(QCoreApplication.translate("Form", u"Thickness", None))
        self.delayLabel.setText(QCoreApplication.translate("Form", u"Delay", None))
        self.pwoerLabel.setText(QCoreApplication.translate("Form", u"Power Ramp (w/s)", None))
        self.deprateLabel.setText(QCoreApplication.translate("Form", u"Dep.Rate", None))
        self.evaporatorLabel.setText(QCoreApplication.translate("Form", u"Evaporator", None))
        self.hmiBtn.setText(QCoreApplication.translate("Form", u"HMI", None))
    # retranslateUi

    # ---------------------------------------------------------------------
    # Custom additions (manual edit)
    # ---------------------------------------------------------------------
    def _apply_custom_ui(self):
        """
        요구사항 반영:
          - HMI쪽 버튼: 기본 빨강
              * 일반(토글 X): pressed 동안만 초록 (Process, HMI)
              * 토글(밸브류): checked(유지) 시 초록
          - Frame(선): 회색, 테두리 없음, 전부 뒤로(lower)
          - 선 정렬: 버튼/Chamber 기준으로 끝점 맞춤
          - 가운데 큰 widget: 회색 + "Chamber" 텍스트
        """
        # 1) 가운데 위젯/그래프 위젯 회색
        self.widget.setStyleSheet("background-color: rgb(220, 220, 220); border: none;")
        self.graphWidget.setStyleSheet("background-color: rgb(220, 220, 220); border: none;")

        # 1-1) 가운데 위젯에 'Chamber' 텍스트
        self._ensure_chamber_label()

        # 2) 버튼 스타일
        toggle_qss = """
        QPushButton {
            background-color: rgb(220, 0, 0);
            color: white;
            border: none;
            border-radius: 6px;
        }
        QPushButton:checked {
            background-color: rgb(0, 170, 0);
        }
        QPushButton:pressed {
            background-color: rgb(0, 170, 0);
        }
        QPushButton:disabled {
            background-color: rgb(160, 160, 160);
            color: rgb(240, 240, 240);
        }
        """
        momentary_qss = """
        QPushButton {
            background-color: rgb(255, 255, 255);
            color: rgb(0, 0, 0);
            border: 1px solid rgb(180, 180, 180);
            border-radius: 6px;
        }
        QPushButton:hover {
            background-color: rgb(245, 245, 245);
        }
        QPushButton:pressed {
            background-color: rgb(235, 235, 235);
        }
        QPushButton:disabled {
            background-color: rgb(230, 230, 230);
            color: rgb(140, 140, 140);
        }
        """

        # 2-1) 토글(밸브/동작) 버튼들
        toggle_buttons = [
            self.vvBtn, self.doorBtn,
            self.ftmBtn, self.mainshutterBtn,
            self.ms1powerBtn, self.ms1shutterBtn,
            self.ms2powerBtn, self.ms2shutterBtn,
            self.rvBtn, self.mvBtn, self.fvBtn, self.rpBtn,
            self.pushButton_13,  # TMP
        ]
        for b in toggle_buttons:
            b.setCheckable(True)
            b.setChecked(False)
            b.setStyleSheet(toggle_qss)

        # 2-2) 일반 버튼(토글 X): Process, HMI
        for b in (self.processBtn, self.hmiBtn):
            b.setCheckable(False)
            b.setStyleSheet(momentary_qss)

        # 3) Frame(선) 스타일 + 뒤로 보내기
        frame_qss = "background-color: rgb(150, 150, 150); border: none;"
        frames = [
            self.frame, self.frame_2, self.frame_3, self.frame_4, self.frame_5, self.frame_6,
            self.frame_7, self.frame_8, self.frame_9, self.frame_10, self.frame_11, self.frame_12,
            self.frame_13, self.frame_14, self.frame_15, self.frame_16, self.frame_17,
            self.frame_18, self.frame_19, self.frame_20,
        ]
        for f in frames:
            f.setFrameShape(QFrame.Shape.NoFrame)
            f.setFrameShadow(QFrame.Shadow.Plain)
            f.setStyleSheet(frame_qss)
            f.setAttribute(Qt.WidgetAttribute.WA_TransparentForMouseEvents, True)

        # 4) 선 정렬(끝점 딱 맞춤)
        self._align_hmi_frames()
        
        # Process 버튼 높이를 F.T.M과 동일하게
        self.processBtn.move(self.processBtn.x(), self.ftmBtn.y())
        self._ensure_air_water_allstop()

        # 5) frame은 전부 뒤로
        for f in frames:
            f.lower()

        # 버튼/위젯은 앞으로
        for b in toggle_buttons:
            b.raise_()
        self.processBtn.raise_()
        self.widget.raise_()

    def _ensure_air_water_allstop(self):
        """
        요구사항:
        - 상단에 Air/Water 인디케이터 추가
        - 위치: F.T.M과 같은 높이(y), 우측 F/V 버튼 영역 상단(x 기준)
        - All Stop 버튼은 인디케이터 '왼쪽'에 붙여서 배치
        """
        # 이미 만들어져 있으면(재호출 대비) 위치만 갱신
        ftm_y = self.ftmBtn.geometry().y()          # F.T.M과 같은 높이
        fv_g = self.fvBtn.geometry()                # 우측 기준
        x_anchor = fv_g.x()                         # F/V 버튼의 x를 기준으로 위에 배치

        led_d = 34          # 원형 LED 지름
        text_h = 18         # 라벨 높이
        gap = 14            # Air-Water 간격
        label_gap = 4       # LED-텍스트 간격

        # 인디케이터 2개가 들어갈 전체 폭
        indicators_w = led_d * 2 + gap
        indicators_x = x_anchor + (fv_g.width() - indicators_w) // 2  # F/V 폭 중앙 정렬
        led_y = ftm_y + 6  # 버튼과 시각적으로 맞추려고 약간 내려줌(원하면 0으로)

        # All Stop 버튼(인디케이터 왼쪽에 붙임)
        all_w = 140
        all_h = 71
        all_x = indicators_x - 10 - all_w
        all_y = ftm_y

        # --- 생성(최초 1회) ---
        if not hasattr(self, "allStopBtn"):
            self.allStopBtn = QPushButton(self.page)
            self.allStopBtn.setObjectName("allStopBtn")
            self.allStopBtn.setText("ALL STOP")
            self.allStopBtn.setStyleSheet("""
                QPushButton{
                    background-color: rgb(180,180,180);
                    color: rgb(200,0,0);
                    border: none;
                    border-radius: 10px;
                    font-weight: 800;
                    font-size: 16px;
                }
                QPushButton:pressed{
                    background-color: rgb(150,150,150);
                }
            """)

            # Air LED + label
            self.airLed = QLabel(self.page)
            self.airLed.setObjectName("airLed")
            self.airText = QLabel(self.page)
            self.airText.setObjectName("airText")
            self.airText.setText("Air")
            self.airText.setAlignment(Qt.AlignmentFlag.AlignHCenter | Qt.AlignmentFlag.AlignTop)

            # Water LED + label
            self.waterLed = QLabel(self.page)
            self.waterLed.setObjectName("waterLed")
            self.waterText = QLabel(self.page)
            self.waterText.setObjectName("waterText")
            self.waterText.setText("Water")
            self.waterText.setAlignment(Qt.AlignmentFlag.AlignHCenter | Qt.AlignmentFlag.AlignTop)

            # 기본 색(원하면 초기값 red로 바꿔도 됨)
            self.airLed.setStyleSheet(f"""
                background-color: rgb(0,200,0);
                border: 2px solid rgb(80,80,80);
                border-radius: {led_d//2}px;
            """)
            self.waterLed.setStyleSheet(f"""
                background-color: rgb(0,200,0);
                border: 2px solid rgb(80,80,80);
                border-radius: {led_d//2}px;
            """)
            self.airText.setStyleSheet("color: rgb(30,30,30); font-weight: 700;")
            self.waterText.setStyleSheet("color: rgb(30,30,30); font-weight: 700;")

        # --- 위치 갱신(항상) ---
        self.allStopBtn.setGeometry(all_x, all_y, all_w, all_h)

        air_x = indicators_x
        water_x = indicators_x + led_d + gap

        self.airLed.setGeometry(air_x, led_y, led_d, led_d)
        self.airText.setGeometry(air_x - 10, led_y + led_d + label_gap, led_d + 20, text_h)

        self.waterLed.setGeometry(water_x, led_y, led_d, led_d)
        self.waterText.setGeometry(water_x - 10, led_y + led_d + label_gap, led_d + 20, text_h)

        # 프레임이 뒤로 가더라도 얘네는 앞으로 보이게
        self.allStopBtn.raise_()
        self.airLed.raise_()
        self.airText.raise_()
        self.waterLed.raise_()
        self.waterText.raise_()

    def _ensure_chamber_label(self):
        # 중복 생성 방지
        if getattr(self, "_chamberLabel", None) is not None:
            # 위젯 크기 변경에 대비해 geometry만 갱신
            self._chamberLabel.setGeometry(QRect(0, 0, self.widget.width(), self.widget.height()))
            return

        self._chamberLabel = QLabel(self.widget)
        self._chamberLabel.setObjectName("chamberLabel")
        self._chamberLabel.setText("Chamber")
        self._chamberLabel.setAlignment(Qt.AlignmentFlag.AlignCenter)
        self._chamberLabel.setGeometry(QRect(0, 0, self.widget.width(), self.widget.height()))

        font = QFont()
        font.setPointSize(22)
        font.setBold(True)
        self._chamberLabel.setFont(font)

        self._chamberLabel.setStyleSheet(
            "background: transparent; color: rgb(90, 90, 90);"
        )
        self._chamberLabel.raise_()

    def _align_hmi_frames(self):
        """
        프레임을 '선'처럼 쓰되, 교차/접점이 1px도 어긋나지 않게
        (가로선/세로선이 thickness만큼 겹치도록) 재배치
        """
        t = 16
        half = t // 2

        def center_x(r: QRect) -> int:
            return r.x() + r.width() // 2

        def center_y(r: QRect) -> int:
            return r.y() + r.height() // 2

        # x_left/x_right는 "edge" 개념(좌/우 끝), y_center는 중심
        def set_hline(frame: QFrame, x_left: int, x_right: int, y_center: int):
            if x_right < x_left:
                x_left, x_right = x_right, x_left
            frame.setGeometry(QRect(int(x_left), int(y_center - half), int(x_right - x_left), t))

        # y_top/y_bottom은 "edge" 개념(상/하 끝), x_center는 중심
        def set_vline(frame: QFrame, x_center: int, y_top: int, y_bottom: int):
            if y_bottom < y_top:
                y_top, y_bottom = y_bottom, y_top
            frame.setGeometry(QRect(int(x_center - half), int(y_top), t, int(y_bottom - y_top)))

        # ---- 기준 지오메트리 ----
        ch = self.widget.geometry()
        ch_left = ch.left()
        ch_right = ch.right() + 1
        ch_top = ch.top()
        ch_bottom = ch.bottom() + 1

        vv = self.vvBtn.geometry()
        door = self.doorBtn.geometry()
        ftm = self.ftmBtn.geometry()
        main = self.mainshutterBtn.geometry()

        ms1p = self.ms1powerBtn.geometry()
        ms1s = self.ms1shutterBtn.geometry()
        ms2p = self.ms2powerBtn.geometry()
        ms2s = self.ms2shutterBtn.geometry()

        rv = self.rvBtn.geometry()
        mv = self.mvBtn.geometry()
        rp = self.rpBtn.geometry()

        # ---- y 중심들 ----
        y_vv = center_y(vv)
        y_door = center_y(door)
        y_main = center_y(main)
        y_ms1p = center_y(ms1p)
        y_ms1s = center_y(ms1s)
        y_ms2p = center_y(ms2p)
        y_ms2s = center_y(ms2s)

        y_rv = center_y(rv)
        y_mv = center_y(mv)
        y_rp = center_y(rp)

        # ---- 왼쪽/아래 4개 수직 바(Chamber 아래로 내려오는 라인) ----
        # Chamber 폭 기준으로 4개를 균등 느낌으로 배치
        w = ch.width()
        bar1_xc = ch_left + int(w * 0.16)  # MS1 Power 쪽
        bar2_xc = ch_left + int(w * 0.33)  # MS1 Shutter 쪽
        bar3_xc = ch_left + int(w * 0.67)  # MS2 Shutter 쪽
        bar4_xc = ch_left + int(w * 0.84)  # MS2 Power 쪽

        # ---- 1) V/V, Door -> Chamber 좌측 ----
        # 가로선은 버튼 오른쪽 edge에서 시작해서 Chamber 안쪽으로 half만큼 겹치게
        set_hline(self.frame_10, vv.right() + 1, ch_left + half, y_vv)
        set_hline(self.frame_7,  door.right() + 1, ch_left + half, y_door)

        # ---- 2) FTM -> Chamber 상단 ----
        ftm_xc = center_x(ftm)
        set_vline(self.frame_12, ftm_xc, ftm.bottom() + 1, ch_top + half)

        # ---- 3) Chamber 우측 -> Main Shutter ----
        set_hline(self.frame_11, ch_right - half, main.left() + half, y_main)

        # ---- 4) Chamber 아래 -> 4개 수직 바 ----
        # 수직바는 Chamber 하단과 가로선이 "겹치게" (끝에 half 오버랩)
        set_vline(self.frame_9, bar1_xc, ch_bottom - half, y_ms1p + half)
        set_vline(self.frame_5, bar2_xc, ch_bottom - half, y_ms1s + half)
        set_vline(self.frame_6, bar3_xc, ch_bottom - half, y_ms2s + half)
        set_vline(self.frame_8, bar4_xc, ch_bottom - half, y_ms2p + half)

        # ---- 5) MS1 Power/Shutter 가로선 ----
        set_hline(self.frame,   ms1p.right() + 1, bar1_xc + half, y_ms1p)
        set_hline(self.frame_2, ms1s.right() + 1, bar2_xc + half, y_ms1s)

        # ---- 6) MS2 Power/Shutter 가로선 ----
        set_hline(self.frame_3, bar4_xc - half, ms2p.left() + half, y_ms2p)
        set_hline(self.frame_4, bar3_xc - half, ms2s.left() + half, y_ms2s)

        # ---- 7) Chamber -> 오른쪽 매니폴드(사각 라인) ----
        # 기존 우측 프레임들의 x 위치를 anchor로 쓰면(디자이너 기반) 라인 조합이 더 안정적으로 딱 맞음
        rect_left_xc = center_x(self.frame_15.geometry())   # 좌측 수직(내부)
        rect_right_xc = center_x(self.frame_16.geometry())  # 우측 수직(내부)
        outer_right_xc = center_x(self.frame_19.geometry()) # 외곽 수직(맨 오른쪽)

        # 연결 y는 Door 라인 레벨이 스샷과 가장 비슷 (중간 펌핑 라인)
        y_conn = y_door

        # Chamber 오른쪽에서 rect_left로 (겹침 포함)
        set_hline(self.frame_17, ch_right - half, rect_left_xc + half, y_conn)

        # ---- 8) 내부 사각( RV 레벨 / MV 레벨 ) ----
        # 좌/우 수직: RV~MV
        set_vline(self.frame_15, rect_left_xc, y_rv - half, y_mv + half)
        set_vline(self.frame_16, rect_right_xc, y_rv - half, y_mv + half)

        # 상단/중단 가로: 좌수직~우수직
        set_hline(self.frame_14, rect_left_xc - half, rect_right_xc + half, y_rv)
        set_hline(self.frame_13, rect_left_xc - half, rect_right_xc + half, y_mv)

        # ---- 9) 외곽 루프: rect_right -> outer_right (y_conn), outer_right 내려가서 RP로 ----
        set_hline(self.frame_20, rect_right_xc - half, outer_right_xc + half, y_conn)
        set_vline(self.frame_19, outer_right_xc, y_conn - half, y_rp + half)

        # RP는 버튼 오른쪽 edge에서 시작해서 outer_right로
        set_hline(self.frame_18, rp.right() + 1, outer_right_xc + half, y_rp)

